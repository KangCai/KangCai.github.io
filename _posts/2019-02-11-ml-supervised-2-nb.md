---
layout: post
title: "机器学习 · 监督学习篇 II"
subtitle: "朴素贝叶斯"
author: "Kang Cai"
header-img: "img/post-bg-dreamer.jpg"
header-mask: 0.4
tags:
  - 机器学习
  - 机器学习·监督学习篇
---

文本相关分类，比如过滤恶意留言，或者过滤垃圾邮件等任务，一种十分常用的方法就是朴素贝叶斯分类模型。本文将会从概念、公式推导、代码实现、应用等角度详细介绍朴素贝叶斯模型。

### 一、朴素贝叶斯

贝叶斯很多人都知道或者有所耳闻，统计学上有一个出名的贝叶斯学派和贝叶斯定理：贝叶斯学派详细介绍可参见《总览篇·III》；而贝叶斯定理是上学时可能会接触到的，对于事件 A、B，其发生概率为 P(A)、P(B)，则有，

<img src="https://latex.codecogs.com/gif.latex?P(B|A)=\frac{P(A|B)P(B)}{P(A)}" />

这个定理最大的作用就是告诉我们 A、B 两个事件之间后验概率的关系和转化方式。该定理在机器学习中应用最广泛的两种模型是决策树模型（Decision Tree）和朴素贝叶斯模型（Naive Bayesian Model，NBM）。其中决策树模型是在80年代提出的，而朴素贝叶斯模型发源于古典数学理论有着坚实的数学基础。朴素贝叶斯，之所以称之为朴素，是因为其中引入了几个假设，而正因为这几个假设的引入，使得模型简单、朴素、易理解。

##### 1.1 公式推导

首先，在朴素贝叶斯分类模型中，命，

<img src="https://latex.codecogs.com/gif.latex?\begin{aligned}&space;(1)\&space;x=\{a_1,a_2,...,a_m\}\\&space;(2)\&space;C=\{y_1,y_2,...,y_n\}\\&space;\end{aligned}"  />

其中（1）式中 x 是待分类样本，每个 a 是 x 的一个特征属性，（2）式中 C 是类别集合。分类目的是在样本出现 x 特征情况时，该样本最有可能是属于哪一类，朴素贝叶斯做法很直接，先计算该样本属于每个类别的后验概率，

<img src="https://latex.codecogs.com/gif.latex?(3)\&space;P(y_1|x),P(y_2|x),...,P(y_n|x)" />

求得（3）式中样本属于各个类别的后验概率后，选择后验概率最大的类别作为样本分类类别。所以现在的关键点就是如何计算（3）式中的各个条件概率，这个时候就用上了贝叶斯定理，

<img src="https://latex.codecogs.com/gif.latex?(4)\&space;P(y_i|x)=\frac{P(x|y_i)P(y_i)}{P(x)}" />

其中 P(x) 表示的是样本呈现出 x 的特征形式的概率，这个概率通常会看成一个常数，所以我们的目的是求（4）式中分子最大对应的类别 i，而分子都是可以直接求出的量，但问题是 x 本身在训练参考样本中出现的次数就不会太多，各个类别的 <img src="https://latex.codecogs.com/gif.latex?P(x|y_i)"/> 出现的次数就更少了，这样得到的概率值意义不大，所以直接求这个后验概率没什么用。但我们发现 x 的每个属性 a 出现的次数会多很多，所以这里为了让分类模型能够 work，就要引入朴素贝叶斯假设了，即认为各个特征属性 a 都是互相独立的，那么将（4）式分子部分中 <img src="https://latex.codecogs.com/gif.latex?P(x|y_i)"/> 展开有，

<img src="https://latex.codecogs.com/gif.latex?(5)\&space;P(x|y_i)P(y_i)=P(a_1|y_i)P(a_2|y_i)...P(a_m|y_i)=P(y_i)\prod_{j=1}^{m}P(a_j|y_i)"/>

所以最后朴素贝叶斯模型要做的事情就只是统计一下各个类别 y 下的各个 a 出现的概率，以及类别 y 本身出现的概率，就可以对新样本 x' 进行分类了。

从上述公式推导过程中可以看到，朴素贝叶斯不同于其它模型，没有复杂的优化过程，所需估计的参数也很少，效率极高，对缺失数据不太敏感，理论上，朴素贝叶斯分类模型与其他分类方法相比具有最小的误差率；但由于各个特征属性 a 都是互相独立的这一朴素假设在实际应用中往往是不成立的，朴素贝叶斯分类效果并没有理论上的那么完美。

##### 1.2 Python 实现

如文章开头所述，一个典型的朴素贝叶斯模型应用场景是垃圾文本过滤，本小节就只用 numpy 库手写实现手机短信垃圾（SMS Spam）分类，选用的数据集是经典的 [SMS Spam Collection v. 1](http://www.dt.fee.unicamp.br/~tiago/smsspamcollection/)，共5,574条短信，其中垃圾短信747条，非垃圾短信4827条。

